version: 1.0
runtime: nodejs18
build:
  commands:
    build:
      - echo "=== Starting build process ==="
      - echo "Node version $(node --version)"
      - echo "NPM version $(npm --version)"
      - npm install --include=dev
      - echo "=== Dependencies installed ==="
      - npm run clean || echo "Clean step skipped"
      - echo "=== Starting TypeScript compilation ==="
      - npm run build
      - echo "=== Build completed checking output ==="
      - ls -la bin/ || echo "bin directory not found after build"
      - ls -la bin/script/ || echo "bin/script directory not found after build"
      - echo "=== Build process finished ==="
run:
  command: npm start
  network:
    port: 8080
    env: PORT
  env:
    - name: NODE_ENV
      value: production
    - name: DEBUG
      value: "*"
    - name: USE_JSON_STORAGE
      value: "true"